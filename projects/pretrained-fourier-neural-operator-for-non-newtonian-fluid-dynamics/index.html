<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Pretrained Fourier Neural Operator for Non-Newtonian Fluid Dynamics | Kozak Hou </title> <meta name="author" content="Kozak Hou"> <meta name="description" content="Kozak Hou, Yi-Che Hsieh"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.css" rel="stylesheet"> <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/locales-all.min.js"></script> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/acm.png?b0d69408ee54d096702cdace5938cc5e"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://kozakhou.github.io/projects/pretrained-fourier-neural-operator-for-non-newtonian-fluid-dynamics/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Kozak</span> Hou </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/schedule/">Schedule </a> </li> <li class="nav-item "> <a class="nav-link" href="/CV/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">People </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Pretrained Fourier Neural Operator for Non-Newtonian Fluid Dynamics</h1> <p class="post-description">Kozak Hou, Yi-Che Hsieh</p> </header> <article> <blockquote class="block-warning"> <h5 id="disclaimer">Disclaimer</h5> <p>The dataset presented in this project is generated from the Moldex3D simulation software, which is a commercial software for simulating the injection molding process. The dataset is not publicly available, and the results are for demonstration purposes only. The project is a proof-of-concept to apply the Fourier Neural Operator (FNO) to learn and infer the physical mode in mold flow analysis. The project is not intended for commercial use or any other purposes.</p> </blockquote> <p><br></p> <h2 id="abstract">Abstract</h2> <p>The project applies the Fourier Neural Operator (FNO) from ICLR 2021, “Fourier Neural Operator for Parametric Partial Differential Equations,” to learn and infer the physical mode in mold flow analysis. FNO is a data-driven approach to solving PDEs in mapping the function in Fourier function spaces rather than finite-dimensional Euclidean spaces. The goals of the project are to learn the physical mode of non-Newtonian fluid dynamics and to predict the pressure (with a MAE of less than 3 Pa) and Melt Front Time (with a MAE of less than 0.3 s).</p> <p><br></p> <h2 id="fourier-neural-operator-fno">Fourier Neural Operator (FNO)</h2> <p>Fourier Neural Operator (FNO) is a data-driven approach to solving PDEs in mapping the function in Fourier function spaces, which is infinite-dimensional, rather than finite-dimensional Euclidean spaces. The first step of the FNO model is to project the input data to high-dimensional Fourier space, then eliminate the high-frequency components and add the residual part, and finally map the data back to the original space. The FNO model is defined as:</p> <p><strong>Definition 1 (Iterative updates)</strong> Define the update to the representation \(v_t \rightarrow v_{t+1}\) by</p> \[v_{t+1}(x) := \sigma(Wv_t(x) + (K(\alpha; \phi)v_t)(x)), \quad \forall x \in D\] <p><strong>Definition 2 (Kernel integral operator \(K\))</strong> Define the kernel integral operator mapping by</p> \[(K(\alpha; \phi)v)(x) := \int_D k(x, y, \alpha(x), \alpha(y)) \phi(v(y)) dy, \quad \forall x \in D\] <p><strong>Definition 3 (Fourier integral operator \(K\))</strong> Define the Fourier integral operator</p> \[(K(\phi)v)(x) := F^{-1}(R_{\phi} \cdot (Fv))(x), \quad \forall x \in D\] <p>The Fourier transform and its inverse are defined respectively as:</p> \[(\mathcal{F}f_j)(k) = \int_D f_j(x) e^{-2\pi i k \cdot x} \, dx\] \[(\mathcal{F}^{-1}f_j)(x) = \int_D f_j(k) e^{2\pi i k \cdot x} \, dk\] <p>which can be illustrated in the following diagram:</p> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fno_ffbd-480.webp 480w,/assets/img/fno_ffbd-800.webp 800w,/assets/img/fno_ffbd-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fno_ffbd.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>FNO Functional Flow Block Diagram</p> <p>Credit: <a href="https://arxiv.org/abs/2010.08895" rel="external nofollow noopener" target="_blank">arXiv:2010.08895</a></p> </div> <p><br></p> <h2 id="dataset">Dataset</h2> <p>The dataset is generated from the Moldex3D simulation software, which is a commercial software for simulating the injection molding process. The dataset consists of 45 runs of mold flow analysis, each having 456391 data points in a 3D plastic injection molding machine, which is a typical geometry in the injection molding process. The dataset includes the following condtions and features in the same geometry of the injection molding machine: [<strong>cooling_time</strong>, <strong>filling_speed</strong>, <strong>VP_position</strong>, <strong>packing_pressure_1</strong>, <strong>packing_pressure_2</strong>, <strong>packing_pressure_3</strong>, <strong>packing_time_1</strong>, <strong>packing_time_2</strong>, <strong>packing_time_3</strong>, <strong>tube_temperature</strong>, <strong>mold_temperatire</strong>, <strong>weight</strong>]</p> <p>The target variables are the pressure and Melt Front Time (MFT). The pressure is the pressure of the plastic in the mold cavity, and the MFT is the time for the plastic to fill the mold cavity.</p> <p>The dataset is split into 40 runs for training and 5 runs for testing. The training dataset is used to train the FNO model, and the testing dataset is used to evaluate the model performance.</p> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cae_part-480.webp 480w,/assets/img/cae_part-800.webp 800w,/assets/img/cae_part-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cae_part.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>Geometry of the Injection Molding Machine</p> </div> <p><br></p> <h2 id="results">Results</h2> <p>The results of the project are to predict the pressure and Melt Front Time (MFT) in the injection molding process. The model is trained with the FNO model, and the results are evaluated with the Mean Absolute Error (MAE) metric.</p> <h5 id="pressure-prediction">Pressure Prediction</h5> <p><strong>Testing MAE: 2.92408 Pa</strong> <br> <strong>Testing MSE: 13.77572 Pa</strong></p> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cae_pressure_train-480.webp 480w,/assets/img/cae_pressure_train-800.webp 800w,/assets/img/cae_pressure_train-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cae_pressure_train.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cae_pressure_test-480.webp 480w,/assets/img/cae_pressure_test-800.webp 800w,/assets/img/cae_pressure_test-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cae_pressure_test.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>Left: Pressure Prediction in Training, Right: Pressure Prediction in Testing</p> <p>Red: CAE Solution, Blue: FNO Prediction</p> </div> <div class="row justify-content-sm-center"> <div class="col-sm-7 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cae_pressure_3d-480.webp 480w,/assets/img/cae_pressure_3d-800.webp 800w,/assets/img/cae_pressure_3d-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cae_pressure_3d.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>3D plot of CAE Solution and FNO Prediction</p> </div> <p><br></p> <h5 id="melting-front-time-mft-prediction">Melting Front Time (MFT) Prediction</h5> <p><strong>Testing MAE: 0.24002 s</strong> <br> <strong>Testing MSE: 0.00895 s</strong></p> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cae_mlt_train-480.webp 480w,/assets/img/cae_mlt_train-800.webp 800w,/assets/img/cae_mlt_train-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cae_mlt_train.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cae_mlt_test-480.webp 480w,/assets/img/cae_mlt_test-800.webp 800w,/assets/img/cae_mlt_test-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cae_mlt_test.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>Left: MLT Prediction in Training, Right: MLT Prediction in Testing</p> <p>Red: CAE Solution, Blue: FNO Prediction</p> </div> <div class="row justify-content-sm-center"> <div class="col-sm-7 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cae_mlt_3d-480.webp 480w,/assets/img/cae_mlt_3d-800.webp 800w,/assets/img/cae_mlt_3d-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cae_mlt_3d.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>3D plot of CAE Solution and FNO Prediction</p> </div> <h2 id="conclusion">Conclusion</h2> <p>In this project, it is evident that the FNO model has the potential to capture the physical mode of non-Newtonian fluid dynamics in the injection molding process. The model can predict the pressure and Melt Front Time (MFT) with a Mean Absolute Error (MAE) of less than 3 Pa and 0.3 s, respectively. We can even observe that the FNO predicts almost on par with the average oscillation produced by CAE numerical simulations. Furthermore, the model’s performance can be further improved by tuning the hyperparameters and increasing the training dataset. This improvement is evident from both the training and testing results, which help to eliminate the spikes in the prediction.</p> <p><br></p> <h3 id="acknowledgements">Acknowledgements</h3> <p>We would like to thank the Moldex3D R&amp;F team for providing the dataset and the Moldex3D software for the simulation. Also, we would like to thank <a href="https://www.nchc.org.tw/" rel="external nofollow noopener" target="_blank">National Center for High Perforamnce Computing</a> and <a href="https://www.twcc.ai/" rel="external nofollow noopener" target="_blank">TWCC</a> for providing the computing resources for this project.</p> <p><br></p> <h3 id="references">References</h3> <ul> <li><a href="https://arxiv.org/abs/2010.08895" rel="external nofollow noopener" target="_blank">Fourier Neural Operator for Parametric Partial Differential Equations</a></li> <li><a href="https://www.moldex3d.com/en/" rel="external nofollow noopener" target="_blank">Moldex3D</a></li> </ul> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Kozak Hou. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?b7816bd189846d29eded8745f9c4cf77"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script src="/assets/js/shortcut-key.js"></script> </body> </html>