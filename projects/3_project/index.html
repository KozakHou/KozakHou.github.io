<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> High Performance Computing with NVIDIA-RAPIDS | Kozak Hou </title> <meta name="author" content="Kozak Hou"> <meta name="description" content="Kozak Hou"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.css" rel="stylesheet"> <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/locales-all.min.js"></script> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A6%88&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://kozakhou.github.io/projects/3_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Kozak</span> Hou </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/Projects/">Projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/Publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/schedule/">Schedule </a> </li> <li class="nav-item "> <a class="nav-link" href="/CV/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/People/">People </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">High Performance Computing with NVIDIA-RAPIDS</h1> <p class="post-description">Kozak Hou</p> </header> <article> <h2 id="problem-statement">Problem Statement</h2> <p>The goal of this project is to implement a high performance computing (HPC) application using NVIDIA-RAPIDS. The dataset used for this project are the EMNIST dataset and the hyperscan data from Japanese satellite, HIMAWARI -8. The application will be implemented using Python and the RAPIDS library, which is a collection of GPU-accelerated data science libraries.</p> <p><br></p> <h2 id="nvidia-rapids">NVIDIA-RAPIDS</h2> <p>RAPIDS is a suite of open-source software libraries and APIs built on CUDA that allows end-to-end data science and analytics pipelines entirely on GPUs. It is designed to be a drop-in replacement for the most popular data science libraries, such as Pandas, Scikit-learn, and Numpy. The code below shows how to import the RAPIDS libraries from CPU-based packages to GPU-based packages. you can find more information about RAPIDS <a href="https://rapids.ai/" rel="external nofollow noopener" target="_blank">here</a>.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">df</span> 
<span class="kn">import</span> <span class="n">cudf</span> <span class="c1"># CUDA-DATAFRAME
</span>
<span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">...</span><span class="sh">'</span><span class="p">)</span>
<span class="n">cudf</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">...</span><span class="sh">'</span><span class="p">)</span>


<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">cupy</span> <span class="k">as</span> <span class="n">cp</span> <span class="c1"># CUDA-ARRAY
</span>
<span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">cp</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="kn">from</span> <span class="n">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span> <span class="k">as</span> <span class="n">skRF</span> 
<span class="kn">from</span> <span class="n">cuml.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span> <span class="k">as</span> <span class="n">cumlRF</span> <span class="c1"># CUDA-RANDOM-FOREST
</span>
<span class="nf">skRF</span><span class="p">()</span>
<span class="nf">cumlRF</span><span class="p">()</span>
</code></pre></div></div> <p><br></p> <h2 id="emnist-dataset">EMNIST Dataset</h2> <p>The EMNIST dataset is a set of handwritten character digits derived from the NIST Special Database 19 and converted to a 28x28 pixel image format and dataset structure that directly matches the MNIST dataset. The EMNIST dataset is split into two sets: the EMNIST ByClass and the EMNIST ByMerge. The EMNIST ByClass dataset is a set of characters with 814,255 labeled examples. The EMNIST ByMerge dataset is a set of characters with 814,255 labeled examples. The code below shows how to load the EMNIST dataset using the RAPIDS library.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">cudf</span>
<span class="kn">import</span> <span class="n">cupy</span> <span class="k">as</span> <span class="n">cp</span>

<span class="kn">from</span> <span class="n">cuml.datasets</span> <span class="kn">import</span> <span class="n">fetch_openml</span>

<span class="n">emnist</span> <span class="o">=</span> <span class="nf">fetch_openml</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">EMNIST_Balanced</span><span class="sh">'</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">emnist</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="n">emnist</span><span class="p">.</span><span class="n">target</span>
</code></pre></div></div> <p><br></p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/emnist_demo-480.webp 480w,/assets/img/emnist_demo-800.webp 800w,/assets/img/emnist_demo-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/emnist_demo.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>EMNIST dataset</p> </div> <p><br></p> <h2 id="hyperscan-data">Hyperscan Data</h2> <p>The hyperscan data from the Japanese satellite, HIMAWARI-8, is a set of images with 16 labeled classes (9 were used in this project). The hyperscan data is used to analysis the weather conditions in Japan and Taiwan such as lonitude, latitude, temperature, humidity, precipitation, and etc. It provides a high-resolution image (2 x 2</p> \[{km}^2\] <p>) of the Earth’s surface every 10 minutes.</p> <blockquote> <h5 id="reminder">Reminder</h5> <p class="block-warning">This project won’t be able to provide the hyperscan data from the Japanese satellite, HIMAWARI-8, since it is a proprietary data needed to be authorized by JAXA (Japan Aerospace Exploration Agency). The results demonstrating in this project are dedicating to present the time consumption and performance of the RAPIDS library.</p> </blockquote> <p><br></p> <h2 id="results">Results</h2> <h4 id="emnist-dataset-1"><strong>EMNIST Dataset</strong></h4> <p>For the EMNIST dataset, I only tested it whether it can be trained by scikit-learn and cuml, and used SVM as the classifier. However, after serveral attempts, I found that <font color="#f00">the scikit-learn is not able to train the EMNIST dataset</font>. Therefore, the only results presented for the EMNIST dataset are implemented using cuml.SVM() below. For detailed implementation, you can find it <a href="https://github.com/KozakHou/cuDF-and-cuML/blob/main/MNIST_EMNIST.ipynb" rel="external nofollow noopener" target="_blank">here</a></p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/rapids_emnist-480.webp 480w,/assets/img/rapids_emnist-800.webp 800w,/assets/img/rapids_emnist-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/rapids_emnist.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>Time Consumption for EMNIST with RAPIDS</p> </div> <p><br></p> <h4 id="hyperscan-data-1"><strong>Hyperscan Data</strong></h4> <p>The results for discussing the HyperScan data are divided into two parts: CPU-based and GPU-based. The CPU-based results are implemented using the Pandas, Numpy, and Scikit-learn libraries. The GPU-based results are implemented using the RAPIDS library. In this project, I personally tested the results from the following CPU and GPU with no parallelism and no optimization.</p> <ul> <li> <p>CPU:</p> <ul> <li>Intel Core Xeon(R) CPU Gold 6334 @ 3.60GHz - (Scikit-learn)</li> <li>Intel Core Xeon(R) CPU Platinum 8280 @ 2.70GHz - (Scikit-learn)</li> <li>Intel Core i7-9750H CPU @ 2.60GHz - (Scikit-learn)</li> <li>AMD Ryzen 7 4800H with Radeon Graphics @ 3.00GHz - (Scikit-learn)</li> <li>AMD Ryzen 7 4800HS with Radeon Graphics @ 3.00GHz - (Scikit-learn)</li> </ul> </li> <li> <p>GPU:</p> <ul> <li>NVIDIA GeForce GTX 1660 Ti Laptop GPU - (RAPIDS)</li> <li>NVIDIA GeForce RTX 3070 Ti Laptop GPU - (RAPIDS)</li> <li>NVIDIA GeForce RTX Quadro 5000 - (RAPIDS)</li> <li>NVIDIA A100-SXM4-40GB - (RAPIDS)</li> </ul> </li> <li> <p>Apple M1 - (Scikit-learn only)</p> </li> </ul> <p>The results are shown in the table below (Trained by Random Forest Regressor (default setting)).</p> <div class="row justify-content-sm-center"> <div class="col-sm-12 mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/rapids_hpc-480.webp 480w,/assets/img/rapids_hpc-800.webp 800w,/assets/img/rapids_hpc-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/rapids_hpc.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>Time Consumption for training Himawari-8 dataset</p> </div> <p><br></p> <p>It is evidently that the RAPIDS shows a significant improvement in the time consumption compared to the CPU-based libraries. Inarguably, the A100-SXM4-40GB GPU is the best performer in this project. In addition, we can see that AMD Ryzen 7 4800HS has slightly better performance than AMD Ryzen 7 4800H, which is due to the higher clock speed. The Apple M1 is also tested in this project, but it is not able to run the RAPIDS lirary.</p> <p><strong>The results are not optimized and parallelized, and the performance may vary in different environments.</strong></p> <p><br></p> <h2 id="references">References</h2> <ul> <li><a href="https://rapids.ai/" rel="external nofollow noopener" target="_blank">RAPIDS</a></li> <li><a href="https://www.nist.gov/itl/iad/image-group/emnist-dataset" rel="external nofollow noopener" target="_blank">EMNIST</a></li> <li><a href="https://www.data.jma.go.jp/mscweb/en/himawari89/" rel="external nofollow noopener" target="_blank">HIMAWARI-8</a></li> <li><a href="https://www.jaxa.jp/" rel="external nofollow noopener" target="_blank">JAXA</a></li> </ul> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Kozak Hou. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?b7816bd189846d29eded8745f9c4cf77"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script src="/assets/js/shortcut-key.js"></script> </body> </html>