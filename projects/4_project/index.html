<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Comparing Kalman Filter with Recurrent-based machine learning on Satellite Attitude Determination | Kozak Hou </title> <meta name="author" content="Kozak Hou"> <meta name="description" content="Kozak Hou, Jih-Hong Shue"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.css" rel="stylesheet"> <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/locales-all.min.js"></script> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A6%88&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://kozakhou.github.io/projects/4_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Kozak</span> Hou </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/Projects/">Projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/Publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/schedule/">Schedule </a> </li> <li class="nav-item "> <a class="nav-link" href="/CV/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/People/">People </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Comparing Kalman Filter with Recurrent-based machine learning on Satellite Attitude Determination</h1> <p class="post-description">Kozak Hou, Jih-Hong Shue</p> </header> <article> <p><br></p> <h2 id="problem-statement">Problem Statement</h2> <p>Satellite Attitude Determination and Control System (ADCS) is an essential component for almost every satellite mission. It provides the satellite in-suite velocity and orientation information. However, we do not have enough ground station to track every satellite in the sky. Therefore, we need to develop an onboard system to estimate the satellite’s attitude. The widely used method is the Kalman Filter or its upgraded version, the Extended Kalman Filter. However, the Kalman Filter is not suitable for nonlinear systems. Therefore, we need to develop a new method to estimate the satellite’s attitude. The goal of this project is to compare the Kalman Filter with Recurrent-based machine learning (Bi-GRU) on Satellite Attitude Determination.</p> <p><br></p> <h4 id="kalman-filter-kf">Kalman Filter (KF)</h4> <p>The Kalman Filter is an algorithm that uses a series of measurements observed over time, containing statistical noise and other inaccuracies, and produces estimates of unknown variables that tend to be more accurate than those based on a single measurement alone. KF is a recursive algorithm that estimates the state of a linear dynamic system from a series of noisy measurements.</p> <h5 id="derivation-of-kalman-filter">Derivation of Kalman Filter</h5> <p>KF is derived from the following assumptions:</p> <ol> <li>The state transition matrix \(A\) and the observation matrix \(H\) are linear.</li> <li>The process noise \(Q\) and the observation noise \(R\) are Gaussian white noise.</li> <li>The initial state \(x_{0}\) and the initial state covariance \(P_{0}\) are known.</li> <li>The control input \(u_{k}\) is known.</li> <li>The observation vector \(z_{k}\) is known.</li> </ol> <p>where \(x_{k}\) is the state vector, \(A\) is the state transition matrix, \(B\) is the control input matrix, $u_{k}$ is the control input, \(P_{k}\) is the state covariance matrix, \(Q\) is the process noise covariance matrix, \(K_{k}\) is the Kalman Gain, \(H\) is the observation matrix, \(R\) is the observation noise covariance matrix, and \(z_{k}\) is the observation vector, then derived from the following steps:</p> <p><strong>Predict</strong>: Predict the state vector \(\hat{x}_{k}\) and the state covariance matrix \(P_{k}\) using the state transition matrix \(A\), the control input matrix \(B\), the control input \(u_{k}\), the state covariance matrix \(P_{k-1}\), and the process noise covariance matrix \(Q\).</p> <p><strong>Update</strong>: Update the state vector \(\hat{x}_{k}\) and the state covariance matrix \(P_{k}\) using the Kalman Gain \(K_{k}\), the observation matrix \(H\), the observation noise covariance matrix \(R\), the observation vector \(z_{k}\), and the state vector \(\hat{x}_{k}\).</p> <p>The following mathematical equations show how the Golden Rules of KF works:</p> \[\begin{aligned} \text{Predict:} \quad &amp; \hat{x}_{k} = A \hat{x}_{k-1} + B u_{k} \\ &amp; P_{k} = A P_{k-1} A^{T} + Q \\ &amp; \\ \text{Update:} \quad &amp; K_{k} = P_{k} H^{T} (H P_{k} H^{T} + R)^{-1} \\ &amp; \hat{x}_{k} = \hat{x}_{k} + K_{k}\left(z_{k} - H \hat{x}_{k}\right) \\ &amp; P_{k} = (I - K_{k} H) P_{k} \end{aligned}\] <p>It is an optimal estimator that minimizes the mean squared error of the estimated state vector \(\hat{x}_{k}\).</p> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/kal_demo-480.webp 480w,/assets/img/kal_demo-800.webp 800w,/assets/img/kal_demo-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/kal_demo.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>Iillustration of how Kalman Filter works</p> </div> <p><br></p> <h4 id="recurrent-based-machine-learning-bi-gru">Recurrent-based machine learning (Bi-GRU)</h4> <p>The Recurrent-based machine learning (Bi-GRU) is a type of neural network that is suitable for sequential data. It is a type of Recurrent Neural Network (RNN) that is capable of learning long-term dependencies with following configuration : [<strong>Forward GRU</strong>, <strong>Backward GRU</strong>]. The following mathematical equations show how the Bi-GRU works:</p> \[\begin{aligned} \text{Forward GRU:} \quad &amp; z_{t} = \sigma\left(W_{z} x_{t} + U_{z} h_{t-1} + b_{z}\right) \\ &amp; r_{t} = \sigma\left(W_{r} x_{t} + U_{r} h_{t-1} + b_{r}\right) \\ &amp; \tilde{h}_{t} = \tanh\left(W h_{t-1} + U\left(r_{t} \odot x_{t}\right) + b\right) \\ &amp; h_{t} = z_{t} \odot h_{t-1} + (1 - z_{t}) \odot \tilde{h}_{t} \\ &amp; \\ \text{Backward GRU:} \quad &amp; z_{t} = \sigma\left(W_{z} x_{t} + U_{z} h_{t+1} + b_{z}\right) \\ &amp; r_{t} = \sigma\left(W_{r} x_{t} + U_{r} h_{t+1} + b_{r}\right) \\ &amp; \tilde{h}_{t} = \tanh\left(W h_{t+1} + U\left(r_{t} \odot x_{t}\right) + b\right) \\ &amp; h_{t} = z_{t} \odot h_{t+1} + (1 - z_{t}) \odot \tilde{h}_{t} \end{aligned}\] <p>where \(x_{t}\) is the input vector at time \(t\), \(h_{t}\) is the hidden state vector at time \(t\), \(W_{z}\), \(U_{z}\), \(b_{z}\), \(W_{r}\), \(U_{r}\), \(b_{r}\), \(W\), \(U\), \(b\) are the weight matrices and bias vectors, \(\sigma\) is the sigmoid activation function, \(\tanh\) is the hyperbolic tangent activation function, and \(\odot\) is the element-wise multiplication.</p> <p><br></p> <h2 id="dataset">Dataset</h2> <p>The dataset used for this project is credited to the 3U CubeSat - (<a href="https://www.sciencedirect.com/science/article/abs/pii/S0273117720300302" rel="external nofollow noopener" target="_blank">IDEASSat/INSPIRESat-2</a>), which saved its ADCS data in ECEF (Earth-Centered, Earth-Fixed) coordinate system in every 30 seconds. However, due to single particle event and minor hardware failure, the data is not continuous. Therefore, we concatenate the data from different days to form a continuous dataset (since it will pass by the same ground station every day, we can observe from the data that it does have some periodicity after we drop the data with single particle event).</p> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/v_ecef-480.webp 480w,/assets/img/v_ecef-800.webp 800w,/assets/img/v_ecef-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/v_ecef.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>Concate the data from different days</p> </div> <p><br></p> <p>In addition, we also use the <a href="https://www.ansys.com/zh-cn/products/missions/ansys-stk" rel="external nofollow noopener" target="_blank">System Tool Kit (STK)</a> to simulate the IDEASSat in the ECEF coordinate system. The following image shows the ECEF Velocity - Xaxis of the IDEASSat simulated by STK with the same time period as the dataset.</p> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/stk_ecef-480.webp 480w,/assets/img/stk_ecef-800.webp 800w,/assets/img/stk_ecef-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/stk_ecef.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>System Tool Kit simulation of IDEASSat</p> </div> <h2 id="results">Results</h2> <p>The following results show the comparison between the Kalman Filter and Bi-GRU on the ECEF Velocity - Xaxis of the IDEASSat.</p> <h4 id="kalman-filter">Kalman Filter</h4> <ul> <li> <p><strong>Position and Velocity</strong>: Estimate the satellite’s initial position \(x_0\) and velocity \(\dot{x}_0\).</p> </li> <li> <p>\(P_0\): A diagonal covariance matrix representing the error in the initial state estimate.</p> </li> <li> <p>\(Q\): Reflects uncertainty in the model predictions, to be estimated based on actual conditions.</p> </li> <li> <p>\(R\): Represents noise and uncertainty in measurements, such as radar measurement errors.</p> </li> <li> <p>\(A\): Describes how the state (position and velocity) transitions from one time step to the next.</p> </li> <li> <p>\(H\): Matrix used to transform state variables into observable quantities. In this case, it is the identity matrix.</p> </li> </ul> <p><br></p> <h4 id="bi-gru">Bi-GRU</h4> <ul> <li> <strong>Features</strong>: ECEF Coordinate - Xaxis, ECEF Coordinate - Yaxis, ECEF Coordinate - Zaxis, ECEF Acceleration - Xaxis, ECEF Acceleration - Yaxis, ECEF Acceleration - Zaxis</li> <li> <strong>Target</strong>: ECEF Velocity - Xaxis</li> </ul> <div class="row justify-content-sm-center"> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/kmf-480.webp 480w,/assets/img/kmf-800.webp 800w,/assets/img/kmf-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/kmf.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-10 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/bigru-480.webp 480w,/assets/img/bigru-800.webp 800w,/assets/img/bigru-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/bigru.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>Comparison between Kalman Filter and Bi-GRU on ECEF Velocity - Xaxis of the IDEASSat</p> <p> Upper: Kalman Filter, Lower: Bi-GRU</p> </div> <p><br></p> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/bi_gru_kmf_loss-480.webp 480w,/assets/img/bi_gru_kmf_loss-800.webp 800w,/assets/img/bi_gru_kmf_loss-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/bi_gru_kmf_loss.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>Loss graph of Bi-GRU</p> </div> <p><br></p> <p>I also implemented the same Bi-GRU model on the STK simulated data. Showing that the Bi-GRU can well capture the periodicity of the IDEASSat.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/stk_bigru-480.webp 480w,/assets/img/stk_bigru-800.webp 800w,/assets/img/stk_bigru-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/stk_bigru.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <p>Bi-GRU on STK simulated data</p> </div> <p><br></p> <h2 id="conclusion">Conclusion</h2> <p>In this project, we discuss the derivation of the Kalman Filter and the Bi-GRU. We also compare the Kalman Filter with the Bi-GRU on the ECEF Velocity - Xaxis of the IDEASSat. The results show that the Bi-GRU can well capture the periodicity of the IDEASSat. However, it only slightly competes with the Kalman Filter on this non-linear system, which means that it may not outperform the Extended Kalman Filter. There are several studies that show Recurrent-based machine learning can outperform the Kalman Filter on the non-linear system. Therefore, we need to further investigate the Bi-GRU on the non-linear system to see if it can outperform the Kalman Filter, or the more important, obtain more consistent and continuous dataset to improve the performance of the Bi-GRU.</p> <p><br></p> <h2 id="references">References</h2> <ul> <li>Zhou, M., Xu, G., Li, X., &amp; Wang, Y. (2021). Title of the Article. Remote Sensing, 13(6), 1185. https://doi.org/10.3390/rs13061185</li> <li>Li, X. R., &amp; Jilkov, V. P. (2000). Survey of maneuvering target tracking: Dynamic models. In O. E. Drummond (Ed.), Proceedings of SPIE (Vol. 4048, pp. 212-235). https://doi.org/10.1117/12.391979</li> <li>MATLAB Linear Kalman Filter. (n.d.). Retrieved from https://www.mathworks.com/help/fusion/ug/linear-kalman-filters.html</li> <li>Meng, S., Jiang, X.Q., Gao, Y., Hai, H. (2020). Performance evaluation of channel decoder based on recurrent neural network. Journal of Physics: Conference Series, 1438(1), 012001. https://doi.org/10.1088/1742-6596/1438/1/012001</li> </ul> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Kozak Hou. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?b7816bd189846d29eded8745f9c4cf77"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script src="/assets/js/shortcut-key.js"></script> </body> </html>